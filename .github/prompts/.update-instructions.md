## Prompt: Maven Project â€“ Upgrade Vulnerable Libraries
kafka-sink-azure-kusto is a Java project managed by Maven, and I need to identify and upgrade libraries with known vulnerabilities, especially focusing on CVEs marked as medium severity or higher. I want you to think step-by-step to ensure dependencies are properly isolated and upgraded. 


Follow this detailed process:

### Step 1: Identify Vulnerabilities
You are a Maven dependency auditor

Begin by running the command:


```shell
mvn org.owasp:dependency-check-maven:aggregate
```
This command should scan the Maven project for dependencies with known CVEs.

Once completed, analyze the generated report (typically found in target/dependency-check-report.html) and perform the following actions:

    - Extract the list of dependencies flagged as vulnerable by parsing the table (id=summaryTable).

    - Filter out the ones that are MEDIUM severity or higher.

    - Exclude provided scope (the dependencies in pom.xml that have <scope>provided</scope>) dependencies from the list 

Provide a summary that includes:

Library name

Version

CVE ID(s)

CVSS score

Description (if available)

### Step 2: Identify Transitive Dependencies
For each vulnerable library:

Run:

```shell 
mvn dependency:tree -Dverbose -Dincludes=<groupId>:<artifactId>
```
(Replace <groupId> and <artifactId> with values for each vulnerable library.)

Determine:

Whether the library is a direct dependency or a transitive dependency.

If transitive, identify the parent dependency that introduces it.

### Step 3: Plan the Exclusion and Upgrade Strategy
For each vulnerable transitive dependency open the pom.xml file of your project and plan the following:

Exclude the vulnerable library from the parent dependency using the <exclusions> tag inside the parent <dependency> block.

Then, explicitly add the vulnerable library back in your pom.xml as a direct dependency, using the latest non-vulnerable version.

Make sure to:

Use official Maven repositories (e.g., Maven Central) to find the latest version.

Check release notes or changelogs if possible to ensure compatibility.

Example XML structure:

```xml
<dependency>
    <groupId>parent-lib</groupId>
    <artifactId>parent-artifact</artifactId>
    <version>1.2.3</version>
    <exclusions>
        <exclusion>
            <groupId>vulnerable-lib-group</groupId>
            <artifactId>vulnerable-lib-artifact</artifactId>
        </exclusion>
    </exclusions>
</dependency>

<dependency>
    <groupId>vulnerable-lib-group</groupId>
    <artifactId>vulnerable-lib-artifact</artifactId>
    <version>LATEST_SECURE_VERSION</version>
</dependency>
```

### Step 4: Validate Changes
After updating, re-run the OWASP dependency check:

```sh
mvn org.owasp:dependency-check-maven:aggregate
```
Confirm that:

The updated libraries no longer show vulnerabilities.

There are no new conflicts or missing classes.

The application builds and functions correctly.

### Final Output
I want you to provide:
A table summarizing:

Vulnerable dependency

CVE IDs

Source (direct/transitive)

Parent dependency (if transitive)

Action taken (excluded, replaced, updated)

The updated pom.xml snippets with exclusions and updated dependencies.